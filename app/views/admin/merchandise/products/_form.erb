
<% content_for :head do -%>
  <%= javascript_include_tag 'admin/merchandise_product' %>
<% end %>


<% content_for :below_body do -%>
  <script>
    Hadean.AdminMerchandiseProductForm.initialize(<%= @product.id %>);
  </script>
<% end %>
  
  <%= error_messages_for 'product' %>
  
<fieldset id="admin-product-names" class='span-12'>
  <div class='span-3'>
    <%= form.label :name %>
  </div>
  <div class='span-6 last'>
    <%= form.text_field :name %>
  </div>
<div class='clear'></div>
  <div class='span-3'>
    <%= form.label :description %>
  </div>
  <div class='span-6 last'>
    <%= form.text_area :description %>
  </div>

</fieldset>



<fieldset id="admin-product-properties" class='span-12'>
  <legend>Properties</legend>
  
  <div id='select-product-prototype'>
    <% select_prototypes = [] << Prototype.new %>
    Prototype: <%= select_tag "select-prototype", 
                              options_from_collection_for_select(select_prototypes + @prototypes, 'id', 'name', ''),
                              {'data-product_id' => @product.id } %>
  </div>
  
  <div id="product_properties" class='span-12 last'>
    <% @all_properties.each do |property| %>
      <div  id='property_<%= property.id %>' 
            class="property_form left span-12 last" 
            <%= "style='display:none;'" if @product.id && !@product.properties.detect {|p| p.id == property.id} %>>
        <%= form.fields_for :product_properties, 
                            property.product_properties.find_or_initialize_by_product_id(@product.id) do |product_property_form|%>
          <div class='span-4 left'> 
            <%= property.display_name %>: 
          </div>
          <%= product_property_form.hidden_field  :property_id %>
          Description: <%= product_property_form.text_field    :description %><br/>
        <% end %>
      </div>
    <% end %>
  </div>

</fieldset>


